<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Linear regression, prediction, and weighting</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Linear regression, prediction, and weighting</h1>



<p>We use the <code>api</code> dataset from package survey to illustrate estimation of a population mean from a sample using a linear regression model. First let’s estimate the population mean of the academic performance indicator 2000 from a simple random sample, <code>apisrs</code>. Using package survey’s GREG estimator <span class="citation">[@Sarndal1992]</span>, we find</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(survey)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">data</span>(api)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># define the regression model</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>model &lt;-<span class="st"> </span>api00 <span class="op">~</span><span class="st"> </span>ell <span class="op">+</span><span class="st"> </span>meals <span class="op">+</span><span class="st"> </span>stype <span class="op">+</span><span class="st"> </span>hsg <span class="op">+</span><span class="st"> </span>col.grad <span class="op">+</span><span class="st"> </span>grad.sch</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># compute corresponding population totals</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>XpopT &lt;-<span class="st"> </span><span class="kw">colSums</span>(<span class="kw">model.matrix</span>(model, apipop))</span>
<span id="cb1-7"><a href="#cb1-7"></a>N &lt;-<span class="st"> </span>XpopT[[<span class="st">&quot;(Intercept)&quot;</span>]]  <span class="co"># population size</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># create the survey design object</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>des &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids=</span><span class="op">~</span><span class="dv">1</span>, <span class="dt">data=</span>apisrs, <span class="dt">weights=</span><span class="op">~</span>pw, <span class="dt">fpc=</span><span class="op">~</span>fpc)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># compute the calibration or GREG estimator</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>cal &lt;-<span class="st"> </span><span class="kw">calibrate</span>(des, <span class="dt">formula=</span>model, <span class="dt">population=</span>XpopT)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">svymean</span>(<span class="op">~</span><span class="st"> </span>api00, des)  <span class="co"># equally weighted estimate</span></span></code></pre></div>
<pre><code>##         mean     SE
## api00 656.58 9.2497</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">svymean</span>(<span class="op">~</span><span class="st"> </span>api00, cal)  <span class="co"># GREG estimate</span></span></code></pre></div>
<pre><code>##         mean     SE
## api00 663.86 4.1942</code></pre>
<p>The true population mean in this case can be obtained from the <code>apipop</code> dataset:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">mean</span>(apipop<span class="op">$</span>api00)</span></code></pre></div>
<pre><code>## [1] 664.7126</code></pre>
<p>Note that the GREG estimate is more accurate than the simple equally weighted estimate, which is also reflected by the smaller estimated standard error of the former.</p>
<p>We can run the same linear model using package mcmcsae. In the next code chunk, function <a href="../html/create_sampler.html"><code>create_sampler</code></a> sets up a sampler function that is used as input to function <a href="../html/MCMCsim.html"><code>MCMCsim</code></a>, which runs a simulation to obtain draws from the posterior distribution of the model parameters. By default three chains with independently generated starting values are run over 1250 iterations with the first 250 discarded as burnin. As the starting values for the MCMC simulation are randomly generated, we set a random seed for reproducibility.</p>
<p>The results of the simulation are subsequently summarized, and the DIC model criterion is computed. The simulation summary shows several statistics for the model parameters, including the posterior mean, standard error, quantiles, as well as the Rhat convergence diagnostic.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">library</span>(mcmcsae)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">set.seed</span>(<span class="dv">21</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>sampler &lt;-<span class="st"> </span><span class="kw">create_sampler</span>(model, <span class="dt">data=</span>apisrs)</span>
<span id="cb7-4"><a href="#cb7-4"></a>sim &lt;-<span class="st"> </span><span class="kw">MCMCsim</span>(sampler, <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>(summ &lt;-<span class="st"> </span><span class="kw">summary</span>(sim))</span></code></pre></div>
<pre><code>## llh_ :
##      Mean        SD   t-value      MCSE     q0.05      q0.5     q0.95     n_eff     R_hat 
## -1.10e+03  2.20e+00 -5.02e+02  4.07e-02 -1.11e+03 -1.10e+03 -1.10e+03  2.91e+03  1.00e+00 
## 
## sigma_ :
##     Mean       SD  t-value     MCSE    q0.05     q0.5    q0.95    n_eff    R_hat 
## 6.06e+01 3.14e+00 1.93e+01 6.07e-02 5.57e+01 6.04e+01 6.61e+01 2.67e+03 1.00e+00 
## 
## reg1 :
##                 Mean     SD t-value    MCSE    q0.05     q0.5    q0.95 n_eff R_hat
## (Intercept)  777.821 24.804   31.36 0.46695  737.793  778.032 818.0877  2822 0.999
## ell           -1.716  0.309   -5.55 0.00575   -2.224   -1.716  -1.2074  2890 1.000
## meals         -1.744  0.276   -6.32 0.00504   -2.198   -1.746  -1.2904  3000 1.000
## stypeH      -108.765 14.060   -7.74 0.25669 -131.772 -109.147 -85.6129  3000 0.999
## stypeM       -59.444 12.316   -4.83 0.22486  -79.715  -59.410 -39.4082  3000 0.999
## hsg           -0.695  0.435   -1.60 0.00831   -1.412   -0.703   0.0248  2743 1.001
## col.grad       1.225  0.499    2.46 0.01072    0.418    1.224   2.0599  2164 1.000
## grad.sch       2.214  0.499    4.43 0.00912    1.374    2.216   3.0150  3000 1.002</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">compute_DIC</span>(sim)</span></code></pre></div>
<pre><code>##         DIC       p_DIC 
## 2217.807439    9.104826</code></pre>
<p>The output of function <a href="../html/MCMCsim.html"><code>MCMCsim</code></a> is an object of class <code>draws</code>. Methods for the generic functions <code>summary</code>, <code>plot</code>, <code>predict</code>, <code>residuals</code> and <code>fitted</code> are currently implemented for this class.</p>
<div id="prediction" class="section level2">
<h2>Prediction</h2>
<p>To compute a model-based estimate of the population mean, we need to predict the values of the target variable for the unobserved units. Let <span class="math inline">\(U\)</span> denote the set of population units, <span class="math inline">\(s \subset U\)</span> the set of sample (observed) units, and let <span class="math inline">\(y_i\)</span> denote the value of the variable of interest taken by the <span class="math inline">\(i\)</span>th unit. The population mean of the variable of interest is <span class="math display">\[
\bar{Y} = \frac{1}{N}\sum_{i=1}^N y_i = \frac{1}{N}\left(\sum_{i\in s} y_i + \sum_{i\in U\setminus s} y_i \right)\,.
\]</span></p>
<p>Posterior draws for <span class="math inline">\(\bar{Y}\)</span> can be obtained by generating draws for the non-sampled population units, summing them and adding the sample sum. This is done in the next code chunk, where method <a href="../html/predict.draws.html"><code>predict</code></a> is used to generate draws from the posterior predictive distribution for the new, unobserved, units.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>m &lt;-<span class="st"> </span><span class="kw">match</span>(apisrs<span class="op">$</span>cds, apipop<span class="op">$</span>cds)  <span class="co"># population units in the sample</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co"># use only a sample of 250 draws from each chain</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>predictions &lt;-<span class="st"> </span><span class="kw">predict</span>(sim, <span class="dt">newdata=</span>apipop[<span class="op">-</span>m, ], <span class="dt">iters=</span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dv">250</span>), <span class="dt">show.progress=</span><span class="ot">FALSE</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="kw">str</span>(predictions)</span></code></pre></div>
<pre><code>## List of 3
##  $ : num [1:250, 1:5994] 746 670 672 706 748 ...
##  $ : num [1:250, 1:5994] 662 759 694 731 633 ...
##  $ : num [1:250, 1:5994] 784 752 711 620 630 ...
##  - attr(*, &quot;class&quot;)= chr &quot;dc&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>samplesum &lt;-<span class="st"> </span><span class="kw">sum</span>(apisrs<span class="op">$</span>api00)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">summary</span>(<span class="kw">transform_dc</span>(predictions, <span class="dt">fun =</span> <span class="cf">function</span>(x) (samplesum <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x))<span class="op">/</span>N))</span></code></pre></div>
<pre><code>##    Mean      SD t-value    MCSE   q0.05    q0.5   q0.95   n_eff   R_hat 
## 664.119   4.206 157.900   0.155 656.896 664.527 670.574 732.308   1.000</code></pre>
<p>The result for the population mean can also be obtained directly (which is more efficient memory wise) by supplying the appropriate aggregation function to the prediction method:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">summary</span>(<span class="kw">predict</span>(sim, <span class="dt">newdata=</span>apipop[<span class="op">-</span>m, ], <span class="dt">fun=</span><span class="cf">function</span>(x, p) (samplesum <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x))<span class="op">/</span>N,</span>
<span id="cb15-2"><a href="#cb15-2"></a>                <span class="dt">show.progress=</span><span class="ot">FALSE</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>)</span></code></pre></div>
<pre><code>##     Mean       SD  t-value     MCSE    q0.05     q0.5    q0.95    n_eff    R_hat 
## 6.64e+02 4.20e+00 1.58e+02 7.78e-02 6.57e+02 6.64e+02 6.71e+02 2.91e+03 1.00e+00</code></pre>
<p>For any linear model one can obtain the same result more efficiently by precomputing covariate population totals. Posterior draws for <span class="math inline">\(\bar{Y}\)</span> are then computed as</p>
<p><span class="math display">\[
\bar{Y}_r = \frac{1}{N} \left( n\bar{y} + \beta_r&#39;(X - n\bar{x}) + e_r\right)\,,
\]</span></p>
<p>where <span class="math inline">\(e_r \sim {\cal N}(0, (N-n)\sigma_r^2)\)</span>, representing the sum of <span class="math inline">\(N-n\)</span> independent normal draws. The code to do this is</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(apisrs)</span>
<span id="cb17-2"><a href="#cb17-2"></a>XsamT &lt;-<span class="st"> </span><span class="kw">colSums</span>(<span class="kw">model.matrix</span>(model, apisrs))</span>
<span id="cb17-3"><a href="#cb17-3"></a>XpopR &lt;-<span class="st"> </span><span class="kw">matrix</span>(XpopT <span class="op">-</span><span class="st"> </span>XsamT, <span class="dt">nrow=</span><span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>predictions &lt;-<span class="st"> </span><span class="kw">predict</span>(sim, <span class="dt">X=</span><span class="kw">list</span>(<span class="dt">reg1=</span>XpopR), <span class="dt">var=</span>N<span class="op">-</span>n, <span class="dt">fun=</span><span class="cf">function</span>(x, p) (samplesum <span class="op">+</span><span class="st"> </span>x)<span class="op">/</span>N,</span>
<span id="cb17-5"><a href="#cb17-5"></a>                       <span class="dt">show.progress=</span><span class="ot">FALSE</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="kw">summary</span>(predictions)</span></code></pre></div>
<pre><code>##     Mean       SD  t-value     MCSE    q0.05     q0.5    q0.95    n_eff    R_hat 
## 6.64e+02 4.17e+00 1.59e+02 7.79e-02 6.57e+02 6.64e+02 6.71e+02 2.87e+03 1.00e+00</code></pre>
</div>
<div id="weights" class="section level2">
<h2>Weights</h2>
<p>To compute weights corresponding to the population total:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>sampler &lt;-<span class="st"> </span><span class="kw">create_sampler</span>(model, <span class="dt">data=</span>apisrs,</span>
<span id="cb19-2"><a href="#cb19-2"></a>                          <span class="dt">linpred=</span><span class="kw">list</span>(<span class="dt">reg1=</span><span class="kw">matrix</span>(XpopT<span class="op">/</span>N, <span class="dt">nrow=</span><span class="dv">1</span>)),</span>
<span id="cb19-3"><a href="#cb19-3"></a>                          <span class="dt">compute.weights=</span><span class="ot">TRUE</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>sim &lt;-<span class="st"> </span><span class="kw">MCMCsim</span>(sampler, <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="kw">plot</span>(<span class="kw">weights</span>(cal)<span class="op">/</span>N, <span class="kw">weights</span>(sim)); <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">sum</span>(<span class="kw">weights</span>(sim) <span class="op">*</span><span class="st"> </span>apisrs<span class="op">$</span>api00)</span></code></pre></div>
<pre><code>## [1] 663.8594</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">summary</span>(sim, <span class="st">&quot;linpred_&quot;</span>)</span></code></pre></div>
<pre><code>## linpred_ :
##     Mean       SD  t-value     MCSE    q0.05     q0.5    q0.95    n_eff    R_hat 
##  663.850    4.217  157.407    0.077  656.883  663.964  670.629 3000.000    1.001</code></pre>
<p>Note the small difference between the weighted sample sum of the target variable and the posterior mean of the linear predictor. This is due to Monte Carlo error; the weighted sum is exact for the simple linear regression case.</p>
</div>
<div id="outliers" class="section level2">
<h2>Outliers</h2>
<p>One possible way to deal with outliers is to use a Student-t sampling distribution, which has fatter tails than the normal distribution. In the next example, the formula.V argument is used to add local variance parameters with inverse chi-squared distributions. The marginal sampling distribution then becomes Student-t. Here the degrees of freedom parameter is modeled, i.e. assigned a prior distribution and inferred from the data.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>sampler &lt;-<span class="st"> </span><span class="kw">create_sampler</span>(model, <span class="dt">formula.V=</span><span class="op">~</span><span class="kw">vfac</span>(<span class="dt">prior=</span><span class="kw">pr_invchisq</span>(<span class="dt">df=</span><span class="st">&quot;modeled&quot;</span>)),</span>
<span id="cb24-2"><a href="#cb24-2"></a>                          <span class="dt">linpred=</span><span class="kw">list</span>(<span class="dt">reg1=</span><span class="kw">matrix</span>(XpopR<span class="op">/</span>N, <span class="dt">nrow=</span><span class="dv">1</span>)),</span>
<span id="cb24-3"><a href="#cb24-3"></a>                          <span class="dt">data=</span>apisrs, <span class="dt">compute.weights=</span><span class="ot">TRUE</span>)</span>
<span id="cb24-4"><a href="#cb24-4"></a>sim &lt;-<span class="st"> </span><span class="kw">MCMCsim</span>(sampler, <span class="dt">n.iter=</span><span class="dv">5000</span>, <span class="dt">burnin=</span><span class="dv">1000</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a>(summ &lt;-<span class="st"> </span><span class="kw">summary</span>(sim))</span></code></pre></div>
<pre><code>## llh_ :
##      Mean        SD   t-value      MCSE     q0.05      q0.5     q0.95     n_eff     R_hat 
## -1081.809     8.610  -125.640     0.865 -1095.666 -1081.948 -1067.340    99.097     1.019 
## 
## sigma_ :
##    Mean      SD t-value    MCSE   q0.05    q0.5   q0.95   n_eff   R_hat 
##  50.159   4.642  10.806   0.422  42.689  50.096  57.899 120.752   1.017 
## 
## linpred_ :
##     Mean       SD  t-value     MCSE    q0.05     q0.5    q0.95    n_eff    R_hat 
## 6.43e+02 3.92e+00 1.64e+02 3.93e-02 6.36e+02 6.43e+02 6.49e+02 9.91e+03 1.00e+00 
## 
## reg1 :
##                 Mean     SD t-value    MCSE    q0.05     q0.5    q0.95 n_eff R_hat
## (Intercept)  792.406 26.230   30.21 0.61985  748.817  792.670 834.5690  1791     1
## ell           -1.496  0.359   -4.17 0.01079   -2.073   -1.503  -0.8972  1105     1
## meals         -2.060  0.357   -5.77 0.01476   -2.669   -2.051  -1.4888   586     1
## stypeH      -105.292 12.916   -8.15 0.13531 -126.366 -105.212 -83.8361  9111     1
## stypeM       -56.992 11.096   -5.14 0.11264  -75.283  -56.985 -38.8345  9703     1
## hsg           -0.676  0.455   -1.49 0.00526   -1.421   -0.674   0.0698  7459     1
## col.grad       1.001  0.486    2.06 0.00684    0.209    0.996   1.7966  5058     1
## grad.sch       2.114  0.467    4.52 0.00489    1.358    2.112   2.8990  9145     1
## 
## vfac1_df :
##    Mean      SD t-value    MCSE   q0.05    q0.5   q0.95   n_eff   R_hat 
##   8.817   5.705   1.546   0.783   3.686   7.077  20.569  53.136   1.042</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">plot</span>(sim, <span class="st">&quot;vfac1_df&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">acceptance_rates</span>(sim)</span></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] 0.2696
## 
## [[1]][[2]]
## [1] 0.2702
## 
## [[1]][[3]]
## [1] 0.2854</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">compute_DIC</span>(sim)</span></code></pre></div>
<pre><code>##       DIC     p_DIC 
## 2195.4577   31.8395</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>predictions &lt;-<span class="st"> </span><span class="kw">predict</span>(sim, <span class="dt">newdata=</span>apipop[<span class="op">-</span>m, ], <span class="dt">show.progress=</span><span class="ot">FALSE</span>,</span>
<span id="cb31-2"><a href="#cb31-2"></a>                       <span class="dt">fun=</span><span class="cf">function</span>(x, p) (samplesum <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x))<span class="op">/</span>N)</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="kw">summary</span>(predictions)</span></code></pre></div>
<pre><code>##    Mean      SD t-value    MCSE   q0.05    q0.5   q0.95   n_eff   R_hat 
##  663.99    4.00  166.09    0.04  657.48  663.98  670.52 9981.56    1.00</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">plot</span>(<span class="kw">weights</span>(cal)<span class="op">/</span>N, <span class="kw">weights</span>(sim)); <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">summary</span>(<span class="kw">get_means</span>(sim, <span class="st">&quot;Q_&quot;</span>)[[<span class="st">&quot;Q_&quot;</span>]])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2342  0.9359  1.0695  1.0002  1.1181  1.1509</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
