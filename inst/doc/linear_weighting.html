<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Linear regression, prediction, and survey weighting</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Linear regression, prediction, and survey
weighting</h1>



<p>We use the <code>api</code> dataset from package survey to illustrate
estimation of a population mean from a sample using a linear regression
model. First let’s estimate the population mean of the academic
performance indicator 2000 from a simple random sample,
<code>apisrs</code>. Using package survey’s GREG estimator <span class="citation">(Särndal, Swensson, and Wretman 1992)</span>, we
find</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(api)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define the regression model</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> api00 <span class="sc">~</span> ell <span class="sc">+</span> meals <span class="sc">+</span> stype <span class="sc">+</span> hsg <span class="sc">+</span> col.grad <span class="sc">+</span> grad.sch</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># compute corresponding population totals</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>XpopT <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">model.matrix</span>(model, apipop))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> XpopT[[<span class="st">&quot;(Intercept)&quot;</span>]]  <span class="co"># population size</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create the survey design object</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>des <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>apisrs, <span class="at">weights=</span><span class="sc">~</span>pw, <span class="at">fpc=</span><span class="sc">~</span>fpc)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the calibration or GREG estimator</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>cal <span class="ot">&lt;-</span> <span class="fu">calibrate</span>(des, <span class="at">formula=</span>model, <span class="at">population=</span>XpopT)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span> api00, des)  <span class="co"># equally weighted estimate</span></span></code></pre></div>
<pre><code>##         mean     SE
## api00 656.58 9.2497</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span> api00, cal)  <span class="co"># GREG estimate</span></span></code></pre></div>
<pre><code>##         mean     SE
## api00 663.86 4.1942</code></pre>
<p>The true population mean in this case can be obtained from the
<code>apipop</code> dataset:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(apipop<span class="sc">$</span>api00)</span></code></pre></div>
<pre><code>## [1] 664.7126</code></pre>
<p>Note that the GREG estimate is more accurate than the simple equally
weighted estimate, which is also reflected by the smaller estimated
standard error of the former.</p>
<p>We can run the same linear model using package mcmcsae. In the next
code chunk, function <a href="../html/create_sampler.html"><code>create_sampler</code></a> sets
up a sampler function that is used as input to function <a href="../html/MCMCsim.html"><code>MCMCsim</code></a>, which runs a
simulation to obtain draws from the posterior distribution of the model
parameters. By default three chains with independently generated
starting values are run over 1250 iterations with the first 250
discarded as burnin. As the starting values for the MCMC simulation are
randomly generated, we set a random seed for reproducibility.</p>
<p>The results of the simulation are subsequently summarized, and the
DIC model criterion is computed. The simulation summary shows several
statistics for the model parameters, including the posterior mean,
standard error, quantiles, as well as the Rhat convergence
diagnostic.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mcmcsae)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>sampler <span class="ot">&lt;-</span> <span class="fu">create_sampler</span>(model, <span class="at">data=</span>apisrs)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">MCMCsim</span>(sampler, <span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>(summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(sim))</span></code></pre></div>
<pre><code>## llh_ :
##       Mean   SD t-value   MCSE q0.05  q0.5 q0.95 n_eff R_hat
## llh_ -1104 2.12    -520 0.0418 -1108 -1104 -1101  2581     1
## 
## sigma_ :
##        Mean   SD t-value   MCSE q0.05 q0.5 q0.95 n_eff R_hat
## sigma_ 60.5 3.11    19.4 0.0631  55.5 60.4    66  2433     1
## 
## reg1 :
##                Mean     SD t-value    MCSE    q0.05    q0.5    q0.95 n_eff R_hat
## (Intercept)  778.32 24.600   31.64 0.44912  737.311  778.33 818.5935  3000 1.000
## ell           -1.72  0.298   -5.79 0.00544   -2.210   -1.72  -1.2382  3000 1.000
## meals         -1.75  0.275   -6.36 0.00502   -2.209   -1.75  -1.3115  3000 1.000
## stypeH      -108.81 14.023   -7.76 0.25603 -131.403 -108.60 -86.1115  3000 1.002
## stypeM       -59.05 12.117   -4.87 0.22122  -78.968  -59.08 -39.2607  3000 0.999
## hsg           -0.70  0.415   -1.69 0.00758   -1.408   -0.70  -0.0101  3000 1.000
## col.grad       1.22  0.487    2.51 0.00889    0.421    1.22   2.0163  3000 1.000
## grad.sch       2.20  0.501    4.39 0.00937    1.402    2.19   3.0274  2859 1.000</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_DIC</span>(sim)</span></code></pre></div>
<pre><code>##         DIC       p_DIC 
## 2217.368326    8.910283</code></pre>
<p>The output of function <a href="../html/MCMCsim.html"><code>MCMCsim</code></a> is an object of
class <code>mcdraws</code>. The package provides methods for the generic
functions <code>summary</code>, <code>plot</code>, <code>predict</code>,
<code>residuals</code> and <code>fitted</code> for this class.</p>
<div id="prediction" class="section level2">
<h2>Prediction</h2>
<p>To compute a model-based estimate of the population mean, we need to
predict the values of the target variable for the unobserved units. Let
<span class="math inline">\(U\)</span> denote the set of population
units, <span class="math inline">\(s \subset U\)</span> the set of
sample (observed) units, and let <span class="math inline">\(y_i\)</span> denote the value of the variable of
interest taken by the <span class="math inline">\(i\)</span>th unit. The
population mean of the variable of interest is <span class="math display">\[
\bar{Y} = \frac{1}{N}\sum_{i=1}^N y_i = \frac{1}{N}\left(\sum_{i\in s}
y_i + \sum_{i\in U\setminus s} y_i \right)\,.
\]</span></p>
<p>Posterior draws for <span class="math inline">\(\bar{Y}\)</span> can
be obtained by generating draws for the non-sampled population units,
summing them and adding the sample sum. This is done in the next code
chunk, where method <a href="../html/predict.mcdraws.html"><code>predict</code></a> is used to
generate draws from the posterior predictive distribution for the new,
unobserved, units.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">match</span>(apisrs<span class="sc">$</span>cds, apipop<span class="sc">$</span>cds)  <span class="co"># population units in the sample</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># use only a sample of 250 draws from each chain</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(sim, <span class="at">newdata=</span>apipop[<span class="sc">-</span>m, ], <span class="at">iters=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="dv">250</span>), <span class="at">show.progress=</span><span class="cn">FALSE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(predictions)</span></code></pre></div>
<pre><code>## List of 3
##  $ : num [1:250, 1:5994] 699 623 586 599 608 ...
##  $ : num [1:250, 1:5994] 704 672 619 746 692 ...
##  $ : num [1:250, 1:5994] 587 701 743 673 582 ...
##  - attr(*, &quot;class&quot;)= chr &quot;dc&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>samplesum <span class="ot">&lt;-</span> <span class="fu">sum</span>(apisrs<span class="sc">$</span>api00)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">transform_dc</span>(predictions, <span class="at">fun =</span> <span class="cf">function</span>(x) (samplesum <span class="sc">+</span> <span class="fu">sum</span>(x))<span class="sc">/</span>N))</span></code></pre></div>
<pre><code>##      Mean   SD t-value  MCSE q0.05 q0.5 q0.95 n_eff R_hat
## [1,]  664 4.12     161 0.151   657  664   671   750     1</code></pre>
<p>The result for the population mean can also be obtained directly
(which is more efficient memory wise) by supplying the appropriate
aggregation function to the prediction method:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">predict</span>(sim, <span class="at">newdata=</span>apipop[<span class="sc">-</span>m, ], <span class="at">fun=</span><span class="cf">function</span>(x, p) (samplesum <span class="sc">+</span> <span class="fu">sum</span>(x))<span class="sc">/</span>N,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">show.progress=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##      Mean   SD t-value  MCSE q0.05 q0.5 q0.95 n_eff R_hat
## [1,]  664 4.21     158 0.083   657  664   671  2565 0.999</code></pre>
<p>For any linear model one can obtain the same result more efficiently
by precomputing covariate population totals. Posterior draws for <span class="math inline">\(\bar{Y}\)</span> are then computed as</p>
<p><span class="math display">\[
\bar{Y}_r = \frac{1}{N} \left( n\bar{y} + \beta_r&#39;(X - n\bar{x}) +
e_r\right)\,,
\]</span></p>
<p>where <span class="math inline">\(e_r \sim {\cal N}(0,
(N-n)\sigma_r^2)\)</span>, representing the sum of <span class="math inline">\(N-n\)</span> independent normal draws. The code to
do this is</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(apisrs)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>XsamT <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">model.matrix</span>(model, apisrs))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>XpopR <span class="ot">&lt;-</span> <span class="fu">matrix</span>(XpopT <span class="sc">-</span> XsamT, <span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(sim, <span class="at">X=</span><span class="fu">list</span>(<span class="at">reg1=</span>XpopR), <span class="at">var=</span>N<span class="sc">-</span>n, <span class="at">fun=</span><span class="cf">function</span>(x, p) (samplesum <span class="sc">+</span> x)<span class="sc">/</span>N,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show.progress=</span><span class="cn">FALSE</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(predictions)</span></code></pre></div>
<pre><code>##      Mean  SD t-value   MCSE q0.05 q0.5 q0.95 n_eff R_hat
## [1,]  664 4.2     158 0.0797   657  664   671  2782 0.999</code></pre>
</div>
<div id="weights" class="section level2">
<h2>Weights</h2>
<p>To compute weights corresponding to the population total:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sampler <span class="ot">&lt;-</span> <span class="fu">create_sampler</span>(model, <span class="at">data=</span>apisrs,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">linpred=</span><span class="fu">list</span>(<span class="at">reg1=</span><span class="fu">matrix</span>(XpopT<span class="sc">/</span>N, <span class="at">nrow=</span><span class="dv">1</span>)),</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">compute.weights=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">MCMCsim</span>(sampler, <span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">weights</span>(cal)<span class="sc">/</span>N, <span class="fu">weights</span>(sim)); <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">weights</span>(sim) <span class="sc">*</span> apisrs<span class="sc">$</span>api00)</span></code></pre></div>
<pre><code>## [1] 663.8594</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(sim, <span class="st">&quot;linpred_&quot;</span>), <span class="at">digits=</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## linpred_ :
##             Mean      SD t-value      MCSE   q0.05    q0.5   q0.95 n_eff    R_hat
## linpred_ 663.792 4.35517 152.415 0.0795141 656.689 663.682 671.264  3000 0.999854</code></pre>
<p>Note the small difference between the weighted sample sum of the
target variable and the posterior mean of the linear predictor. This is
due to Monte Carlo error; the weighted sum is exact for the simple
linear regression case.</p>
</div>
<div id="outliers" class="section level2">
<h2>Outliers</h2>
<p>One possible way to deal with outliers is to use a Student-t sampling
distribution, which has fatter tails than the normal distribution. In
the next example, the formula.V argument is used to add local variance
parameters with inverse chi-squared distributions. The marginal sampling
distribution then becomes Student-t. Here the degrees of freedom
parameter is modeled, i.e. assigned a prior distribution and inferred
from the data.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sampler <span class="ot">&lt;-</span> <span class="fu">create_sampler</span>(model, <span class="at">formula.V=</span><span class="sc">~</span><span class="fu">vfac</span>(<span class="at">prior=</span><span class="fu">pr_invchisq</span>(<span class="at">df=</span><span class="st">&quot;modeled&quot;</span>)),</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">linpred=</span><span class="fu">list</span>(<span class="at">reg1=</span><span class="fu">matrix</span>(XpopR<span class="sc">/</span>N, <span class="at">nrow=</span><span class="dv">1</span>)),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data=</span>apisrs, <span class="at">compute.weights=</span><span class="cn">TRUE</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">MCMCsim</span>(sampler, <span class="at">n.iter=</span><span class="dv">5000</span>, <span class="at">burnin=</span><span class="dv">1000</span>, <span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>(summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(sim))</span></code></pre></div>
<pre><code>## llh_ :
##       Mean   SD t-value  MCSE q0.05  q0.5 q0.95 n_eff R_hat
## llh_ -1081 8.15    -133 0.605 -1094 -1081 -1067   181  1.01
## 
## sigma_ :
##        Mean   SD t-value  MCSE q0.05 q0.5 q0.95 n_eff R_hat
## sigma_ 49.5 4.39    11.3 0.304  42.5 49.4  56.9   209  1.01
## 
## linpred_ :
##          Mean  SD t-value   MCSE q0.05 q0.5 q0.95 n_eff R_hat
## linpred_  643 3.9     165 0.0402   636  643   649  9435     1
## 
## reg1 :
##                 Mean     SD t-value    MCSE    q0.05     q0.5    q0.95 n_eff R_hat
## (Intercept)  793.917 26.129   30.38 0.37692  750.021  794.556 836.0596  4806     1
## ell           -1.485  0.362   -4.10 0.00751   -2.081   -1.491  -0.8870  2329     1
## meals         -2.083  0.358   -5.82 0.00889   -2.681   -2.077  -1.5006  1621     1
## stypeH      -105.409 12.826   -8.22 0.12953 -126.374 -105.356 -83.9533  9806     1
## stypeM       -56.837 10.943   -5.19 0.10842  -74.898  -56.824 -38.6756 10187     1
## hsg           -0.677  0.454   -1.49 0.00562   -1.419   -0.676   0.0663  6524     1
## col.grad       0.967  0.478    2.02 0.00558    0.199    0.963   1.7661  7342     1
## grad.sch       2.114  0.467    4.53 0.00508    1.346    2.110   2.8863  8440     1
## 
## vfac1_df :
##          Mean   SD t-value MCSE q0.05 q0.5 q0.95 n_eff R_hat
## vfac1_df 7.74 4.43    1.75 0.49  3.62 6.36  16.6  81.6  1.03</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim, <span class="st">&quot;vfac1_df&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acceptance_rates</span>(sim)</span></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] 0.2642
## 
## [[1]][[2]]
## [1] 0.2692
## 
## [[1]][[3]]
## [1] 0.2648</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_DIC</span>(sim)</span></code></pre></div>
<pre><code>##       DIC     p_DIC 
## 2194.8432   33.7317</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(sim, <span class="at">newdata=</span>apipop[<span class="sc">-</span>m, ], <span class="at">show.progress=</span><span class="cn">FALSE</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fun=</span><span class="cf">function</span>(x, p) (samplesum <span class="sc">+</span> <span class="fu">sum</span>(x))<span class="sc">/</span>N)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(predictions)</span></code></pre></div>
<pre><code>##      Mean   SD t-value   MCSE q0.05 q0.5 q0.95 n_eff R_hat
## [1,]  664 3.98     167 0.0405   657  664   670  9659     1</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">weights</span>(cal)<span class="sc">/</span>N, <span class="fu">weights</span>(sim)); <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">get_means</span>(sim, <span class="st">&quot;Q_&quot;</span>)[[<span class="st">&quot;Q_&quot;</span>]])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.2103  0.9318  1.0747  1.0003  1.1272  1.1665</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Sarndal1992" class="csl-entry">
Särndal, C.-E., B. Swensson, and J. Wretman. 1992. <em>Model Assisted
Survey Sampling</em>. Springer.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
